<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥æœ¬é—œè¥¿å››åœ‹è¡Œç¨‹(ZTMY)</title>
    
    <!-- è¼‰å…¥å¤–éƒ¨ CSS -->
    <link rel="stylesheet" href="css/itinerary.css">
    
    <!-- é è¼‰å…¥é‡è¦è³‡æº -->
    <link rel="preload" href="js/itinerary.js" as="script">
    <link rel="preload" href="js/notification.js" as="script">
    
    <!-- PWA æ”¯æ´ (é¸ç”¨) -->
    <meta name="theme-color" content="#4299e1">
    <meta name="description" content="æ—¥æœ¬é—œè¥¿å››åœ‹æ—…éŠè¡Œç¨‹ç®¡ç†å·¥å…·">
</head>
<body>
    <!-- é€£ç·šç‹€æ…‹æŒ‡ç¤ºå™¨ (é¸ç”¨) -->
    <div id="connectionStatus" class="connection-status" style="display: none;"></div>
    
    <div class="container">
        <!-- é é¢é ­éƒ¨ -->
        <div class="header">
            <div class="status-indicator" id="statusIndicator">å·²å„²å­˜</div>
            
            <div class="edit-controls">
                <button class="btn btn-primary" id="editBtn" onclick="toggleEditMode()">ç·¨è¼¯æ¨¡å¼</button>
                <button class="btn btn-success" id="saveBtn" onclick="saveItinerary()" style="display: none;">å„²å­˜</button>
                <button class="btn btn-danger" id="cancelBtn" onclick="cancelEdit()" style="display: none;">å–æ¶ˆ</button>
            </div>
            
            <h1 id="title">æ—¥æœ¬é—œè¥¿å››åœ‹è¡Œç¨‹</h1>
            <p id="subtitle">2025å¹´11æœˆ22æ—¥ - 11æœˆ29æ—¥ (8å¤©7å¤œ)</p>
        </div>
        
        <!-- ä¸»è¦å…§å®¹å€åŸŸ -->
        <div class="timeline-section">
            <div class="timeline-header">è¡Œç¨‹æ™‚é–“è»¸</div>
            <div class="timeline" id="timeline">
                <!-- å‹•æ…‹è¼‰å…¥å…§å®¹ -->
                <div class="loading-placeholder" style="padding: 40px; text-align: center; color: #718096;">
                    è¼‰å…¥ä¸­...
                </div>
            </div>
        </div>
    </div>

    <!-- è¼‰å…¥ JavaScript æª”æ¡ˆ -->
    <script src="js/itinerary.js"></script>
    <script src="js/notification.js"></script>
    
    <!-- åˆå§‹åŒ–è…³æœ¬ -->
    <script>
        // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•ä¸­...');
            
            // è¼‰å…¥è¡Œç¨‹è³‡æ–™
            if (typeof loadItinerary === 'function') {
                loadItinerary();
            } else {
                console.error('loadItinerary å‡½æ•¸æœªæ‰¾åˆ°');
            }
            
            // å•Ÿå‹•é€šçŸ¥å®¢æˆ¶ç«¯
            if (window.notification && window.notification.client()) {
                window.notification.client().start();
            }
            
            console.log('âœ… æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–å®Œæˆ');
        });
        
        // å…¨åŸŸéŒ¯èª¤è™•ç†
        window.addEventListener('error', function(event) {
            console.error('å…¨åŸŸéŒ¯èª¤:', event.error);
            
            // é¡¯ç¤ºç”¨æˆ¶å‹å–„çš„éŒ¯èª¤è¨Šæ¯
            if (window.notification) {
                window.notification.showNotification('æ‡‰ç”¨ç¨‹å¼ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹é‡æ–°æ•´ç†é é¢', 'error', 5000);
            }
        });
        
        // æœªæ•æ‰çš„ Promise éŒ¯èª¤
        window.addEventListener('unhandledrejection', function(event) {
            console.error('æœªè™•ç†çš„ Promise éŒ¯èª¤:', event.reason);
            event.preventDefault(); // é˜²æ­¢éŒ¯èª¤å‡ºç¾åœ¨æ§åˆ¶å°
        });
        
        // æ•ˆèƒ½ç›£æ§ (é¸ç”¨)
        if ('performance' in window) {
            window.addEventListener('load', function() {
                const loadTime = performance.now();
                console.log(`ğŸ“Š é é¢è¼‰å…¥æ™‚é–“: ${Math.round(loadTime)}ms`);
            });
        }
    </script>
</body>
</html>